The U.S. stock market is capping a seesaw month by jumping to all-time highs just two weeks after enduring its worst slump since 2012.

Global markets roared higher after Japan's central bank committed to a huge increase in its purchases of bonds and other assets, the country's latest effort to shake off two decades of economic stagnation. 

In the U.S., stocks extended a late-month rally that has been powered by strong corporate earnings. The Dow Jones industrial average rose 168 points, or 1 per cent, to 17,361 near close on Friday afternoon.  

Happy Halloween! The Dow Jones revealed a huge rally today after the Bank of Japan unexpectedly announced new stimulus to boost the country's flagging economic recovery

Costumed characters distribute Hershey candies as trader Edward Curran works on the floor of the New York Stock Exchange on Halloween. U.S. stocks are opening higher following big gains in Asia after Japan made moves to rev up its economy

 The Standard & Poor's 500 index rose 19 points, or 1 percent, to 2,014 and the Nasdaq composite rose 59 points, or 1.3 percent, to 4,625. 

Both the Dow and the S&P 500 index are back at record highs and the Nasdaq composite is at its highest level in 14 years.

It's a remarkable feat for the stock market, especially since Wall Street experienced one of its most volatile months since the 2008 financial crisis. It was a month rocked by massive sell-offs but also record highs in a period of just a few days.

The market weakness investors experienced starting in mid-September spilled over into October. 

Fears that Europe's economy was slipping back into a recession, a plunge in oil prices and some early economic data that showed weakness in the U.S. economy sent investors fleeing the market. Those fears sent stocks, for the most part, straight down for two weeks.

The nadir came October 15, when the S&P 500 nearly went into what's known as a correction, defined as a decline of 10 percent or more in a benchmark index from a recent high.

Many investors have been expecting the stock market to have a correction, a phenomenon that historically occurs every 18 months or so.  The last one happened in late 2011.

Shortly after its mid-October swoon, the market bounced back at a dizzying pace. Strong U.S. corporate earnings were the primary driver of the rebound, as well as signs that central banks in Japan and Europe were going to do all they could to stop their economies from dragging everyone else down with them.

'I don't think it's a surprise that we came close to a correction. We've been expecting one for a while. I think the bigger surprise has been how we rip-roared all the way back up,' said Bob Doll, chief equity strategist at Nuveen Asset Management. 

'When you hit someone over their head with a hammer, you don't expect them to get up immediately.'

The Dow and S&P 500 are up 2 per cent for the month, while the Nasdaq is up nearly 3 per cent.

Friday's gains were driven by the Bank of Japan, which surprised investors by announcing it would increase its bond and asset purchases by 10 trillion yen to 20 trillion yen ($90.7 billion to $181.3 billion) to about 80 trillion yen ($725 billion) annually. 

The announcement came after economic data showed that Japan's economy remained in the doldrums, with household spending dropping and unemployment ticking up.

Japan's move comes only two days after the U.S. Federal Reserve brought an end to its own bond-buying program.

Investors have been hopeful that the European Central Bank might also start buying bonds to stimulate that region's economy by keeping interest rates low and injecting cash into the financial system. That form of stimulus is called quantitative easing, also known among investors as 'QE.'

A man walks past an electronic stock board of a securities firm in Tokyo on Friday. Japan's Nikkei 225 stock average surged 5 per cent and the yen slid against the dollar after the Bank of Japan unexpectedly announced new stimulus to boost a flagging economic recovery

'The Japanese central bank has taken the QE baton from the Fed, and equity traders couldn't be happier,' said David Madden, market analyst at IG.

Japan's stock market rose 4.8 percent to the highest level since 2007.

The Japanese currency weakened dramatically following the Bank of Japan's announcement. The yen slumped 2.6 percent against the dollar to 112 yen. The yen is trading at the lowest level in more than five years. Japanese companies typically like a weak Japanese yen because it makes their exported goods cheaper abroad.

European stock markets rose broadly following the Bank of Japan's announcement on hopes that the ECB could be tempted to follow Japan's lead in stepping up stimulus measures. However, few think anything will be announced at the ECB's next policy meeting next Thursday.

'The willingness of the Bank of Japan to ease further in the fight against deflation will encourage those who think the ECB should be doing the same,' said Julian Jessop, chief global economist at Capital Economics.

Britain's FTSE 100 rose 1.3 percent. France's CAC 40 jumped 2.2 percent and Germany's DAX climbed 2.3 percent.

In the U.S., GoPro jumped $9.84, or 14 percent, to $78.06. The maker of small, wearable video cameras posted profit and revenue that was well ahead of analysts' projections. The company also raised its profit forecast for the fourth quarter.

The price of U.S. benchmark crude oil fell 62 cents to $80.50 a barrel in New York as increasing production from OPEC members added to already high global supplies of oil. Brent crude, used to price oil in international markets, dipped 84 cents to $86.28 in London.

Bond prices fell. The yield on the U.S. 10-year Treasury note rose to 2.34 percent from 2.31 percent Thursday.

In metals trading, the price of gold fell $27 to $1,171.60 an ounce. Silver fell 31 cents to $16.11 an ounce and copper fell 2 cents to $3.05 a pound.

@highlight

The Dow Jones industrial average rose 168 points, or 1 per cent, to 17,361 near close on Friday 

@highlight

In the U.S., stocks extended a late-month rally that has been powered by strong corporate earnings

@highlight

Friday's gains driven by the Bank of Japan, which surprised investors by announcing it would increase its bond and asset purchases by 10 trillion yen to 20 trillion yen annually