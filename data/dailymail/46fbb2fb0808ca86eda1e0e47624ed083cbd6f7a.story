A man who dragged a Highway Patrol trooper over 100 yards down a freeway in his car while high on methamphetamine will spend the next 30 years in prison.

Alan G. Hampton, 42, was attempting to flee a traffic stop in Liberty, Missouri, by taking off but the officer, Cpl Cody Dunfee, dove into the car.

Dunfee had seen Hampton making frantic movements inside his car at about 2am on July 8, 2012 on MO 152 Highway near North Oak Trafficway.

Dunfee shot Hampton in order to stop the car.

Scroll down to see video

Hanging on for dear life: This is the moment Alan Hampton tries to run a traffic stop and Cpl Cody Dunfee clings to the car. He was dragged over 100 years before shooting Hampton, which stopped the car

Dash cam: Missouri trooper Cpl Cody Dunfee is dragged down the road. The incident was caught on the camera inside his car

After: Alan G. Hampton crawls out of his car after being shot by a Highway Patrol trooper

The entire incident was caught on video from the 'dash cam' inside the police car.

Behind bars: Alan G. Hampton has been sentenced to 30 years in prison for a raft of offenses

At Hampton's sentencing on Wednesday, Clay County Circuit Court Judge Elizabeth Davis said it was 'a miracle' neither of the men died.

Dunfee said the situation was 'intense'

'Just because of the fact that I was stuck to that car and the only way I had to get away from that was to fire my service weapon,' he told KTV5.com.

'I just drew my service weapon and more or less dove into the car right after him.

'I actually picked my feet up, so I didn't drag per-se.

'I had no injuries after the fact.

'I put a dent in the back door of the car sometime during the incident and the holster I wear to work today still has the rub marks from that car.'

'A million things were going through my mind.'

Dunfee said he didn't want to injure himself by letting go so deduced that shooting was the only choice he had.

In the video Hampton can be heard saying 'you shot me' over and over.

Troopers found a loaded syringe in the car, methamphetamine and a pistol with blood on it.

The blood belonged to Hampton, so investigators believe he tossed it after he was shot.

Lucky to be alive: Cpl Cody Dunfee was dragged over 100 yards down a freeway by Alan Hampton. 'A million things were going through my mind,' he said

Hampton had multiple felony drug and property crime convictions going back more than 20 years.

'Hampton may argue that getting shot was punishment enough,' said Clay County prosecutor Dan White.

'Getting shot isn't punishment. Getting shot is a consequence of this stupid, dangerous and illegal behavior.'

The 30-year sentence includes six years for resisting arrest, 12 years for possession of a controlled substance, and 12 years for felon in possession of a firearm.

@highlight

Alan G. Hampton was pulled over in Liberty, Missouri, about 2am in July 2012

@highlight

When High Patrol trooper Cpl Cody Dunfee began questioning him, Hampton took

@highlight

Dunfee clung to the car and was dragged down the road, but shot Hampton to halt the car

@highlight

Hampton has now been sentenced to 30 years, with other crimes adding to the time