Sergey Gordeev was a straight A pupil but shot dead his teacher and a police officer at his school

A student gunman has killed a policeman and teacher after holding more than 20 students hostage in a school near Moscow.

The 'straight-A' 16 year old Sergey Gordeev sparked a nationwide security alert amid initial fears his attack at his school near Moscow was a terrorist incident linked to the Winter Olympics which open on Friday.

He held 24 pupils hostage for almost an hour, and gunned down his teacher Andrei Kirillov, a married father with two small children, apparently in revenge for unusually poor marks in geography or biology.

He also shot and killed married policeman Sergei Bushuev, 38, as he fired a volley of 11 shots at officers surrounding the school.

Special forces troops were used to detain him after his father urged him to put down his weapon.

The armed pupil and teacher previously had a conflict over his marks. 

This could have prevented the boy leaving school with a 'gold' medal, say sources at the school. 

A dramatic text message from a girl in Gordeev's class to her mother during the terrifying siege read: 'A machine gun. We are at school. He is shooting. 

'Mama, aaaa-aa-aa. Save me! Its not a joke. Mama. Its awful. He's gone mad. We are hostages on floor 1, room 2.'

Gordeev earlier brandished two rifles to as he overpowered the security man at School Number 263 on the outskirts of Moscow in what was initially seen as a terrorist attack.

Soon it became clear it was a disgruntled pupil who had seized his father's guns to gain revenge on his mild-mannered teacher. 

The rest of the school was evacuated as police ordered the boy's father to call him on his mobile and demand he spares his classmates' lives. 

One teenage girl said: 'He shot the teacher in the stomach. Then he wanted to make sure that he was dead, so he fired another 'insurance' shot to the head.'

The father - believed to be a law enforcement officer - then donned a bullet-proof jacket and negotiated with his son the lay down the guns and surrender.

The move was seen as saving Russia from a school massacre. 

Scroll down for video

Terrified: A girl is hugged by her relative as she is evacuated from her school north of Moscow

Evacuated: Pupils are escorted by a policeman out of their school north of Moscow

Children are evacuated out of the school north of Moscow where a student gunman opened fire

Andrei
 Polipchuk, police spokesman, said: 'All the students are alive, nobody 
is injured. The attacker is arrested, he is identified. 

'He is a student of this very school.'

Reports say the boy's father was involved in persuading him to give himself up and prevent a school massacre. 

'The father of the boy immediately came to the school,' said a local official.

A man stands near a window with bullet holes at a high school in Russia where a student killed a police officer and a teacher

A security service member uses a metal detector near the building of a high school where a student shot his teacher and police officer

A man films on a camera as he stands near a window with bullet holes at the school north of Moscow

Pupils leave their school after a fellow student shot a policeman and teacher dead this morning

Safe: Pupils are led out of the school where a 16-year-old boy shot dead a policeman and teacher

Police gather outside the school north of Moscow where a student went on the rampage with a rifle shooting dead a policeman and teacher

Pictured: The hostage-taker has been named as Sergey Gordeev (pictured) who was a student at the school

A gunman is believed to have shot and killed a police officer and teacher at this school in Moscow

Police outside the school in Moscow where a gunman took a class of children hostage

'Sergei Gordeyev was a straight-A student,' said a spokesman for the Investigative Committee, equivalent of the FBI.

'It appears that he had an emotional breakdown.'

Fellow students said he accused the teacher of giving him low marks so threatening his chance to get a 'gold medal' for academic performance. 

'He persuaded the boy to put down his arms and to let the children go.'

Psychologists are now working with the released children.

The dead policeman was named as Sergei Bushuev.

He died in an ambulance at the scene. A second wounded officer was rushed to Sklifosovsky hospital in Moscow.

Ambulances and police are waiting outside the school on the outskirts of Moscow

Another policeman was shot and injured.

'The person who took 20 people and a teacher hostage is a student in the upper classes at the same school. 

'He has been neutralised and all the students have been freed,' Interior Ministry spokesman Andrei Pilipchuk said on state TV.

'One
 policeman was fatally wounded during the operation and died in hospital
 and a teacher at School No. 263 was also killed,' he said.

The shooting sent dozens of students scurrying out the school while a police helicopter landed in a snow-covered field outside.

It
 came with Russia in the global spotlight four days before it hosts the 
2014 Winter Olympics in the Black Sea resort city of Sochi.

A woman and child walk outside the school where a teacher and police officer were shot by an armed student

Police officers enter a Moscow school with a teacher where two people were killed by a student this morning

@highlight

Pupil held students and a teacher hostage in a biology classroom

@highlight

He was detained after killing a policeman and teacher

@highlight

The hostage-taker named as Sergey Gordeev, believed to be 16

@highlight

Believed the pupil and teacher previously had a conflict over his marks