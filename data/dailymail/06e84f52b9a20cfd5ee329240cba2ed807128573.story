It was a genius ATM hack that allowed two Tennessee men to steal $400,000 in cash.

But in the end it was a stupid move that got them both caught and charged with 30 counts of computer fraud and conspiracy.

Khaled Abdel Fattah, a Nashville restaurateur and chef, and his accomplice Chris Folad are alleged to have used a six-digit default passcodes to cash out money over the course of 18 months in Nashville.

Fattah had insider knowledge of the codes that are set by the makers of the ATMs, according to Help Net Security.

When typed in, the ATMs would revert to 'Operator Mode'.

Fraud charges: Nashville retsaurateur Khaled Abdel Fattah (left) and accomplice Chris Folad are alleged to have used a six-digit default passcode to cash out money $400,000 from convenience store ATMs in Nashville over the course of 18 months

The pair were then able to access the settings and reconfigure the ATM to dispense $20 when asked for $1.

They would insert their own cards, request a $20 withdrawal, and walk away with $400 cash.

The two targeted smaller kiosk or convenience store ATMs around Nashville - larger banks would not have used the same passcode - and they would revert the settings back to normal after each transaction.

It took over a year for anyone to notice.

Finally the owner of a business where one of the ATMs was stationed complained something was wrong.

Customers were withdrawing money and nothing was coming out.

The Secret Service became involved once it was clear this was a major exploit.

They were able to track down Fattah and Folad because they had used the same network of small-time ATMs for their scheme.

The duo were caught on surveillance camera and, most crucially, had used their own debit cards.

Fattah owns the Blu Fig Mediterranean Kitchen in Nashville, a somewhat esteemed establishment.

He was indicted on October 22 and has not commented on the charges

Neither has Folad.

The default pass-codes of ATMs became a problem around 2005 when it was revealed they had been printed in the service manuals for the Tranax and Trident ATMs, according to Wired.

Those manual were available online.

Triton’s master pass-code was '123456'.

Security was amped up in the aftermath.

However in June, two 14-year-old boys in Winnipeg, Canada, who were playing around on the internet, found out how to figure out the default pass-code of a Bank of Montreal ATM in a grocery store.

The teenagers successfully guessed the six-digit code and called the bank to let them know.

 

@highlight

Nashville restaurateur Khaled Fattah and accomplice Chris Folad allegedly used a factor-set default code to reconfigure remote ATMs in Nashville

@highlight

The codes allowed them to change the operator settings of the machines

@highlight

They would trick ATMs into dispensing them $20 notes when asked for $1

@highlight

It netted them $400,000 over 18 months

@highlight

Pair were caught by the Secret Service because they used their own cards 