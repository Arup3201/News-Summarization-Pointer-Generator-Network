Terrifying video footage has revealed the moment a drug dealer pulled out a gun on an undercover cop in Florida.

Scott Perala, an agent for the Bureau of Alcohol, Tobacco and Firearms, was buying two AK-47s and prescription pills from two suspects in a parking lot in Cocoa Beach when the incident unfolded.

Although the confrontation, which was caught on Perala's body camera, occurred in 2010, WESH has just secured the footage.

It shows Perala, who had previously carried out hundreds of successful undercover operations, climbing into the backseat of a car where suspects Jeremy Williams and Beaver Duncan are waiting.

Scroll down for video 

Fears: A suspect can be seen pulling a gun at an undercover agent during a routine operation in Florida. The agent had climbed into their car to buy guns and pills when the two men tried to rob him

Threats: The suspect tells the agent to give him the $2,000 he had brought to buy the guns and pills

After greeting the men, he takes a pouch of Oxycodone pills and starts to count them when he suddenly looks up to see a handgun and an AK-47 being pulled at him.

'It was three inches from my head… that barrel looked like a cannon,' Perala told WESH.

He puts up his hands as he pleads with the men - while they demand him to put down the $2,000 he had brought to purchase the guns and pills.

Perala jumps from the car as a shot is fired at him and, after taking cover behind an SUV, he pulls out his own weapon and fires repeatedly as they drive away.

The men sped off and took shelter behind a daycare, where they were captured following another shootout with responding officers. 

Fighting back: The agent can be seen pulling his gun out and shooting at the suspects as they race away

Lucky escape: Scott Perala, an agent for the Alcohol, Tobacco and Firearms Agency, who was in the video, said the terrifying experience was worth it to keep the men off the streets

Locked up: The two men in the car, Beaver Duncan, left, and Jeremy Williams are now serving life sentences

Duncan's handgun, which was loaded, was later found inside the fence of the daycare.

Williams, Duncan and a third co-conspirator were charged in the case and sentenced to life in prison, KSN reported.

ATF supervisor Joe Lenczyk said 10 other agents were listening and watching when the deal was taking place. He said that agents often carry out their deals in public places.

'Most bad guys aren’t going to [commit a violent act] in broad daylight in a public area,' he said.

But Perala has remained positive about his near-death experience. 

'It's worth it to me if they're off the street,' he said.

See below for video

 

 

@highlight

Undercover agent Scott Perala was on a routine operation when two suspects pulled guns on him as he counted pills in the back of their car

@highlight

They demanded $2,000 from him but he fled and they were later captured

@highlight

The video of the terrifying incident has just emerged and the two men, as well as a third suspect, have now been locked up for life 