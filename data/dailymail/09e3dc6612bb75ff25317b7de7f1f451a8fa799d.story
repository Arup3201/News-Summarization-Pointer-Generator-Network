By 
David Williams

UPDATED:

02:26 EST, 14 September 2011

Security forces killed the last of six Taliban fighters in Kabul today to bring to an end a 20-hour siege on the Afghan capital.

Suicide bombers struck the U.S. embassy and Nato headquarters in the city yesterday in a series of co-ordinated attacks.

It finally ended this morning in a flurry of gunfire as six of the terrorists were killed. At least seven innocent people, including four policemen, were killed in the assault.

The attacks proved yet again that despite massive security, the Taliban can strike at will against key targets in the capital.

Gun-battle: A NATO chopper hovers over the building where Taliban militants took positions to launch attacks in Kabul

Assault: The helicopter circles the building where Taliban fighters are holed up

Ready for action: Afghan soldiers take position at the scene after the Taliban attack

Rockets and bullets were fired into the American compound, while suicide bombers struck against police and intelligence targets.

The insurgents holed up in an unfinished high-rise building overlooking the diplomatic quarter, armed with rockets.

Afghan security forces fought them floor-by-floor during what was the longest sustained attack on the capital since the U.S.-led invasion a decade ago.

A few fighters held out overnight, with residents taking cover indoors with their lights off and helicopters flying low overhead.

U.S. Secretary of State Hillary Clinton condemned the attack on the embassy as 'cowardly'.

Coming two days after the tenth anniversary of the September 11 atrocities, the well-planned assaults carried an unsettling message to Western leaders and their Afghan allies about the resilience and reach of the Taliban network.    

Afghan officials have claimed their capital was protected by a ‘ring of steel’ but there is now concern about their inability to secure the city without Western help.

Last month suicide bombers and gunmen stormed the British Council offices in the city, leaving 12 dead after a seven-hour siege.

On guard: An Afghan soldier stands alert on the gun battle site in Kabul

Stand-off: Afghan security forces fire at the building where armed attackers were holed up for hours

Security services stand by near the building as a soldier runs past during the siege, in which at least seven died

Taliban fighters took over a multi-storey building near the diplomatic district and started firing rockets

A Kabul police official blamed Pakistan-based Taliban militia for the latest attack and said one rocket hit a school bus, but fortunately it was empty.

Taliban spokesman Zabihullah Mujahid said the fighters were armed with rocket-propelled grenades, suicide bomb vests and AK-47 rifles.      

Nato Secretary-General Anders Fogh Rasmussen said the assaults were aimed at thwarting plans to hand over security to Afghan forces but they would not succeed.

‘We are following the events closely; we have confidence in the Afghan authorities’ ability to deal with this situation,’ he said. ‘Transition is on track and it will continue.’

It was the third major attack in Kabul since late June, casting fresh doubts on the ability of Afghans to secure their own country as the U.S. and other foreign troops prepare to withdraw by the end of 2014.

The American Embassy and NATO both said no staff were wounded.

Smoke rises from buildings during the coordinated attack across the Afghan capital

An Afghan policeman keeping watch. Insurgents fired rockets and sent out two suicide bombers

Afghan officials said at least one Afghan police officer, a civilian, and two insurgents had been killed as gunfire and explosions resounded across the city well into the afternoon.

A Kabul police official blamed Pakistan-based Taliban for the attack and said an empty school bus had been destroyed in one blast.

In western Kabul, a few miles away, a suicide bomber detonated explosives at the entrance to a building belonging to the city's civil order police, killing a policeman and wounding two.      

A second suicide bomber killed a civilian at the regional police centre, near the Habibia high school, and wounded four, while at a road near the airport, a suicide bomber was killed by police and 15.5 lb of explosives seized.    

A man shows a piece of armament that he says was from the rocket-propelled attack in Kabul

A school bus, luckily empty at the time, that was damaged by a rocket-propelled attack

The Taliban claimed responsibility. Spokesman Zabihullah Mujahid said the fighters were armed with rocket-propelled grenades, suicide bomb vests and AK-47 rifles, and were targeting government buildings, the U.S. embassy and the headquarters of NATO-led forces.      

NATO Secretary-General Anders Fogh Rasmussen said the assaults were aimed at thwarting plans to hand over security to Afghan forces but they would not succeed.       

'We are following the events closely; we have confidence in the Afghan authorities' ability to deal with this situation,' he added.

Taliban spokesman Zabiullah Mujahid said a number of suicide bombers attacked Afghan and foreign soldiers at Abdul Haq square in central Kabul.

He claimed in a text message sent to reporters that suicide bombers using assault rifles also attacked the offices of the Afghan intelligence service.

@highlight

Rockets fired at U.S. and other embassies in diplomatic zone

@highlight

Gang of insurgents take over empty building and start firing

@highlight

Two suicide bombers strike in other areas, third is shot dead

@highlight

U.S. embassy says all its personnel are safe