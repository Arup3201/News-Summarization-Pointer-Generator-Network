Robin Williams checked into rehab at an addiction treatment center in Minnesota in the weeks before his apparent suicide.

At the time, his representative said, 'After working
 back-to-back projects, Robin is simply taking the opportunity to 
fine-tune and focus on his continued commitment, of which he remains 
extremely proud.'

While he was at Hazeldon Addiction Treatment Center, the actor and comedian paid a visit to a Dairy Queen in Linstrom nearby on June 29.

Scroll down for video

Maintaining his sobriety: On June 29 Robin Williams was spotted at a Dairy Queen in Minnesota, not far from Hazelden, where he was receiving treatment

Looking very slim, Williams posed for a photograph with server Abby Albers in one of the last pictures of his life.

Albers grabbed the opportunity to have her photo taken with Williams, who she said was 'the ONLY famous person' to have ever entered the store.

On Facebook where she posted the picture, she described him as 'friendly,' and said he bought a small vanilla cone but refused to speculate among her friends about the reason for his visit.

In response to someone's suggestion that Williams was attending rehab at Hazeldon, she said '...if he is it's none of our business.'

Williams had often spoken about his problems with drugs and alcohol, and in recent years he admitted he was again struggling. On a recent tour, he even joked about it.

'I went to rehab in wine country,' he said, 'to keep my options open.'

Williams told Parade magazine in 2013 that he had relapsed in 2003 after 20 years of sobriety while filming The Big White.

'One day I walked into a store and saw a little bottle of
Jack Daniel’s. And then that voice — I call it the "lower power' — goes, "Hey. Just
a taste. Just one." I drank it, and there was that brief moment of "Oh, I’m
okay!" But it escalated so quickly. Within a week I was buying so many bottles
I sounded like a wind chime walking down the street. I knew it was really bad
one Thanksgiving when I was so drunk they had to take me upstairs.'

The center: Hazelden is located in Minnesota and their Lodge department specializes in helping patients achieve long-term sobriety

Demanding schedule: Williams, pictured in 2013, had been working nonstop and needed some time for himself, his rep said in June

He described feelings of loneliness and fear that pushed him back towards alcohol at that time.

'I was in a small town where it's not the edge of the
world, but you can see it from there, and then I thought: drinking. I just
thought, hey, maybe drinking will help. Because I felt alone and afraid. It was
that thing of working so much, and going f***, maybe that will help. And it was
the worst thing in the world.'

In 2006, his family held an intervention to force him to get help for his addictions.

He checked into a Hazeldon center in Oregon and admitted he was an alcoholic.

His
 rep said at the time, 'After 20 years of sobriety, Robin Williams found
 himself drinking again and has decided to take proactive measures to 
deal with this for his own well-being and the well-being of his family.'

Robin
 has admitted to problems with cocaine in the late 1970s and early '80s. The death of his friend, comic John Belushi, is what made him 
want to give up drugs. 'Was it a wake-up call?' he said years later. 'Oh
 yeah, on a huge level.'

Most recently, Williams was reportedly staying at Hazelden's The Lodge, which is known for helping patients maintain long-term sobriety.

In 2010, Williams told The Guardian that he was still attending AA meetings weekly.

'Have to,' he said. 'It's good to go.

Prolific tweeter: The Oscar-winner shared many thoughts and images on social media, but had remained silent during August. His last tweet was dedicated to his daughter, Zelda, linking to an Instagram picture of her  when she was a baby

A very big career: In May his film The Angriest Man In Brooklyn with Mila Kunis was released

The Chicago native had a manic shooting schedule this year and had been making movies back-to-back before his death. This year alone he appeared in the films Boulevard with Kathy Baker and The Angriest Man In Brooklyn with Mila Kunis.

In December he will appear in Merry Friggin' Christmas, about a father who drives all night to collect his son's presents.

He also filmed Night At The Museum's Secrets Of The Tomb with Ben Stiller and Rebel Wilson. Williams plays Teddy Roosevelt.

The legendary performer had also completed a TV series The Crazy Ones with Sarah Michelle Gellar.

Legendary: The comedic genius with Pam Dawber in Mork & Mindy, which aired on TV from 1978 and 1982

Happier times: This 2009 file photo shows actor Robin Williams and his wife Susan Schneider at the premiere of Old Dogs in Los Angeles

Williams' wife Susan Schneider confirmed the tragic news of his death today and spoke of her ‘profound grief’.

'This morning, I lost my husband and my best friend, while the world lost one of its most beloved artists and beautiful human beings. I am utterly heartbroken.

'As he is remembered, it is our hope the focus will not be on Robin's death, but on the countless moments of joy and laughter he gave to millions.'

A statement by the Marin County Sheriff's Department in California said: 'On August 11, 2014, at approximately 11:55 am, Marin County Communications received a 911 telephone call reporting a male adult had been located unconscious and not breathing inside his residence in unincorporated Tiburon, California. The male subject, pronounced deceased at 12:02 pm has been identified as Robin McLaurin Williams.'

@highlight

Robin Williams checked into a rehab facility in June 

@highlight

His representative confirmed he was at Hazeldon Addiction Treatment Center

@highlight

Williams was at the center's The Lodge, which helps patients maintain long-term sobriety

@highlight

He had been candid about his struggles with drugs and alcohol in the 1970s and '80s

@highlight

In 2006, he admitted he had relapsed and that his family held an intervention to force him to rehab

@highlight

In 2010, he said in an interview that he still attended AA meetings weekly

@highlight

Williams was found dead of apparent suicide today