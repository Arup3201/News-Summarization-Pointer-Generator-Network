Milos Raonic gatecrashed a party seemingly reserved for the best four players in the world by shocking Rafael Nadal in the quarter-finals of the BNP Paribas Open.

World number one Novak Djokovic and Andy Murray - the Scot who is fourth in the ATP World Tour rankings - were confirmed as semi-final opponents on Thursday and second-best-in-the-world Roger Federer duly followed them into the last four with a 6-4 6-0 victory over Tomas Berdych.

Nadal would have later completed an elite quartet but the Spaniard instead fell to world number six Raonic at the end of three gruelling hours.

Milos Raonic celebrates after booking his semi-final place at Indian Wells by defeating Rafael Nadal

Rafael Nadal waves goodbye after his exit following the three-hour match at Indian Wells

Canadian Raonic stretches to make a return during a match in which he rescued six break points

The sixth seed from Canada looked like he might be heading out after losing the first set inside 36 minutes but he rallied to save three match points in an epic second-set tie-break, forcing a decider.

Raonic, who fired 19 aces and saved six break points, finally ended the Spaniard's perfect record against Canadians by earning a crucial break in the third and clinching a 4-6 7-6 (12/10) 7-5 victory.

He told atpworldtour.com: 'At the moments when I was playing those match points, it didn't really feel like match points.

'It was just like another point that I was trying to get through... (I was) just sort of going through the paces at that moment of what do I need to do now, not really signifying it as a match point.'

Nadal reflects on the quarter-finals defeat, which ended his unbeaten record against Canadian opponents

Nadal hits a powerful return in the quarter-final match, which saw three sets lasting three hours

Raonic celebrates after joining Andy Murray, Roger Federer and Novak Djokovic in the last four

In Federer's earlier meeting with Berdych, the Swiss was first to get a break point opportunity in the fifth game, only for the Czech to save it with a forehand winner.

But Federer broke him in the seventh to go 4-3 up, and seemed to be into his groove from then on as he breezed through the second set.

Federer said: '(It's) not just another win, but another win against a top 10 player; against Berdych, who has played me tough in recent years.'

Roger Federer celebrates after knocking out Czech Tomas Berdych to reach the semi-finals 

Swiss Federer breezed through to the semi-finals in two sets 

Simona Halep of Romania automatically advanced to the women's final after world number one Serena Williams withdrew due to a right knee injury.

In a post on her official Instagram account, the American wrote: 'Four months ago I began a journey to play Indian Wells and it was amazing.

'I never dreamed I could do it. But I would not have been able to do this without my fans.

'Though it ended early due to injury this year, I have to say I cannot wait to try again next year.'

Halep, now one win away from the first Premier Mandatory title of her career, will contest the title with 2010 winner Jelena Jankovic.

The Serbian booked her second appearance in an Indian Wells final with a hard-fought 3-6 6-3 6-1 victory over Sabine Lisicki of Germany.

Serena Williams posted a picture and message on Instagram after withdrawing through injury

 

@highlight

Milos Raonic beat Rafael Nadal 4-6 7-6 (12/10) 7-5 at Indian Wells

@highlight

Canadian sixth seed reaches the semi-finals of the BNP Paribas Open

@highlight

Raonic served 19 aces and saved six break points in the three-hour match

@highlight

He joins Murray, Federer and Djokovic in the last four