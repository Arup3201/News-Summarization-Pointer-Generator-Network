Maria Sharapova was dumped out of the BNP Paribas Open at Indian Wells by defending champion Flavia Pennetta - but world No 1 Serena Williams did manage to reach the quarter-finals.

Fresh from beating Victoria Azarenka in Monday's third round, Sharapova looked ready to continue her fine run of form and took the first set against Pennetta, who looked distracted and emotional throughout the opening games.

The Italian rallied, however, forcing Sharapova into a decider before tightening her grip on the match and closing out a 3-6 6-3 6-2 victory.

Maria Sharapova reaches for a forehand in her defeat by Flavia Pennetta at the BNP Paribas Open 

Italian Pannetta, the defending champion at Indian Wells, won the second and third sets to reach the quarters

Williams had earlier recovered from a nightmare start to overcome her fellow American Sloane Stephens 6-7 (3/7) 6-2 6-2 in the Coachella Valley.

The world's best player dropped her first two service games in the fourth career meeting between two former friends, whose relationship had cooled in the wake of Stephens' solitary win at the 2013 Australian Open.

But Williams became increasingly dominant as the match went on and secured her win in two hours and seven minutes. She will next tackle Timea Bacsinszky in the last eight after the Swiss hopeful's 4-6 6-1 6-1 triumph over Elina Svitolina.

Sharapova waves farewell to the crowd in California after falling to Pannetta in three sets

VIDEO Sharapova out, Serena battles through

Awaiting Pennetta is Germany's 24th seed Sabine Lisicki, who saw off Caroline Garcia 6-4 6-4.

Lesia Tsurenko emerged victorious from an epic late-night battle with sixth seed Eugenie Bouchard.

The Canadian, a Wimbledon finalist last summer, had to scrap to win the first set on a tie-break and could not keep Tsurenko under wraps as the world number 92 steadily turned the screw before clinching a 6-7 (5/7) 7-5 6-4 win after two hours and 50 minutes of play.

Carla Suarez Navarro progressed to the quarter-finals by beating British number one Heather Watson 7-6 (7/5) 3-6 6-1 and standing between her and a place in the final four is Simona Halep, the Romanian who defeated Karolina Pliskova 6-4 6-4.

Elsewhere, Jelena Jankovic reeled off five straight games as she beat Belinda Bencic 6-3 3-6 6-3.

World No 1 Serena Williams (right) shakes hands with fellow American Sloane Stephens after her victory 

In the men's competition, second seed Roger Federer missed two match points but improved to take his revenge on Andreas Seppi with a 6-3 6-4 win.

The Swiss master reached the last eight and a match-up with Jack Sock after dispatching the man who knocked him out of the Australian Open in January.

Sock, the world number 58 from Nebraska, remains in the tournament thanks to his 3-6 6-3 6-2 victory over Roberto Bautista Agut.

Grigor Dimitrov was the surprise casualty on Tuesday as Tommy Robredo set up a quarter-final clash with sixth seed Milos Raonic.

Roger Federer missed two match points before defeatiing Andreas Seppi 6-3 6-4 to reach the last eight

The Spaniard had to steel himself after surrendering the second set but he would prevail 6-4 1-6 7-5, with Raonic joining him in the last eight following a 7-6 (7/2) 6-4 success against Alexandr Dolgopolov.

Third seed Rafael Nadal encountered few problems dispatching Donald Young 6-4 6-2 - he will now meet Gilles Simon, who removed qualifier Michael Berrer from contention with a 6-2 7-5 win - and Tomas Berdych made light work of Steve Johnson, winning 6-4 6-2.

A face-off with Lukas Rosol beckons after the Czech edged out Robin Haase 6-4 6-7 (4/7) 7-6 (7/3).

 

@highlight

Defending champion Flavia Pennetta beat Maria Sharapova in three sets

@highlight

Sharapova won the first set before the Italian rallied to win 3-6 6-3 6-2

@highlight

World No 1 Serena Williams beat Sloane Stephens 6-7 (3/7) 6-2 6-2